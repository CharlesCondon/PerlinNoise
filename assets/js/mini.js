let song,amp,mic,phase=0,zoff=0,spaceSlider,strokeSlider;var starSpeed,stars=[];let rToggle=1,r,g,b;function preload(){song=loadSound("daftPunk.mp3")}function toggleSong(){song.isPlaying()?(song.pause(),document.getElementById("playImg").src="assets/images/playBtn.png"):(song.play(),document.getElementById("playImg").src="assets/images/pauseBtn.png")}function toggleSettings(){let e=document.getElementById("controls");e.classList.toggle("animate__fadeInRight"),e.classList.toggle("hide")}function setup(){createCanvas(windowWidth,windowHeight).parent("visuals");for(var e=0;e<800;e++)stars[e]=new Star;document.getElementById("playBtn").addEventListener("click",toggleSong);document.getElementById("controlsCont").addEventListener("click",toggleSettings),document.getElementById("disco"),amp=new p5.Amplitude,fft=new p5.FFT,spaceSlider=createSlider(.5,15,.1,.1),strokeSlider=createSlider(1,10,2,.5),numSlider=createSlider(1,5,1,1),qSlider=createSlider(1.1,3,1.5,.1),spaceSlider.parent("spacing"),strokeSlider.parent("thickness"),numSlider.parent("dupes"),qSlider.parent("deviation"),windowWidth<600&&(rToggle=.5)}function draw(){disco.checked?(r=Math.floor(255*Math.random())+100,g=Math.floor(255*Math.random())+100,b=Math.floor(255*Math.random())+100):(r=255,g=255,b=255);let e=amp.getLevel();fft.analyze();let t=fft.getCentroid();background(0),translate(width/2,height/2),stroke(r,g,b);let s=strokeSlider.value();beginShape(POINTS),strokeWeight(s);let a=spaceSlider.value(),l=numSlider.value(),n=qSlider.value(),o=500;for(let i=0;i<TWO_PI;i+=radians(a/2)){let p=map(cos(i+phase),-1,1,0,t/o),d=map(sin(i+phase),-1,1,0,t/o),$=map(noise(p,d,zoff),0,1,100,height/2),_=$*rToggle*cos(i),c=$*rToggle*sin(i);vertex(_,c)}if(l>1)for(let f=1;f<l;f++){for(let m=0;m<TWO_PI;m+=radians(a/2)){let u=map(cos(m+phase),-1,1,0,t/o),S=map(sin(m+phase),-1,1,0,t/o),y=map(noise(u,S,zoff),0,1,100,height/2),h=y*rToggle*cos(m),v=y*rToggle*sin(m);vertex(h,v)}o*=n}endShape(CLOSE),starSpeed=map(t/20,0,width,0,50);for(var k=0;k<stars.length;k++)strokeWeight(2),stars[k].update(),stars[k].show();phase+=e/4,zoff+=e/8}